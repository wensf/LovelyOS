define("wkview:widget/doc_header_new/index.js",function(e,n,o){var i=e("wkcommon:widget/lib/tangram/base/base.js"),t=e("wkcommon:widget/ui/js_core/log/log.js"),a=e("wkcommon:widget/ui/lib/jquery/jquery.js"),c=e("wkcommon:widget/ui/js_core/login/login.js"),s=e("wkcommon:widget/lib/fis/data/data.js"),r=e("wkview:widget/doc_header_new/doc_header_qrcode.js"),d=e("wkcommon:widget/ui/lib/string/string.js");e("wkview:widget/ui/view/doc_report/doc_report.js");var l=s.get("WkInfo")||{},u=function(e){a.extend(!0,this.ops,e),this.run()};u.prototype={constructor:u,ops:{id:0,readerType:"html",copyright:""},run:function(){var e=this.ops;"org"===e.veritype&&a(function(){var n=e.oid,o="/org/interface/getorgcount?oid="+n;try{a.getJSON(o,function(e){if(0===e.errno){var n=e.data,o=n.doc_count,i=n.view_count,t=(1*n.score).toFixed(1);a(".doc-count").html(o),a(".view-count").html(i),a(".owner-score").html(t)}})}catch(i){}}),a(window).load(function(){i.lang.eventCenter.dispatchEvent("tagShowLog",{data:e.tagArr,lodActId:101030,index:7})}),r.init(s.get("WkInfo").DocInfo.docId);var n=a(".top-ads-banner .top-ads-banner-goto-cashier"),o=s.get("WkInfo").PageInfo.isLogin,u=s.get("WkInfo").DocInfo.docId,w=a("#top-ads-banner-icon");w.on("click",function(){i.lang.eventCenter.addEventListener("Login.Success",function(e){i.event.stop(e),window.location.href="/cashier/browse/vipcashier?cashier_code=wkview_SepEduDocFree_right0_20150914&from_doc="+u}),c.login.verlogin(function(){window.location.href="/cashier/browse/vipcashier?cashier_code=wkview_SepEduDocFree_right0_20150914&from_doc="+u},null,null,null,!1)}),n.on("click",function(){i.lang.eventCenter.addEventListener("Login.Success",function(e){i.event.stop(e),window.location.href="/cashier/browse/dispatch?dqStatCode=31_8_9_10&from_doc="+u}),o||t.xsend(1,100350),~~l.DocInfo.is_exam_link&&t.xsend(1,100717),c.login.verlogin(function(){t.xsend(1,100350),window.location.href="/cashier/browse/dispatch?dqStatCode=31_8_9_10&from_doc="+u},null,null,null,!1)});var p=a(".ugc-test-user");return p.on("click",function(){t.xsend(1,100506)}),i.lang.eventCenter.addEventListener("docCount.response",function(n){var o,i=[],t='<b class="ic ic-star-s-on"></b>',c="on",s=n.data;if(s&&0===+s.status){var r=l.DocInfo,d=parseInt(r.flag,10);if(s.qualityScore||s.float_valueAverage){o=s.qualityScore?Number(s.qualityScore).toFixed(1):(s.float_valueAverage/2).toFixed(1);var u=o;if(19===+d){i.push('<span title="'+o+"\u5206\uff0c"+s.valueCount+'\u4eba\u8bc4">\u8d28\u91cf\uff1a');for(var w=0;5>w;w++)1>o&&(c=0>=o?"off":"half"),o--,i.push(t.replace("on",c));i.push("</span>"),i.push(u&&+u>=4?'<span class="high-quality">'+u+"</span>\u5206":'<span class="normal-quality">'+u+"</span>\u5206")}else i.push('<b class="bannerScore"></b>'),u&&u>=4&&s.percentage?(i.push('<span class="high-quality">'+u+"\u5206</span>"),i.push('<span>(\u9ad8\u4e8e<span class="high-quality">'+s.percentage+"</span>%\u7684\u6587\u6863)</span>")):u&&u>=2&&s.percentage?(i.push('<span class="normal-quality">'+u+"\u5206</span>"),i.push('<span>(\u9ad8\u4e8e<span class="high-quality">'+s.percentage+"</span>%\u7684\u6587\u6863)</span>")):i.push('<span class="normal-quality">'+u+"\u5206</span>")}else i.push("\u6682\u65e0\u8bc4\u4ef7");i.push("<i>|</i>"),i.push('<span class="ic ic-read-num"></span>'+s.viewCount+"<i>|</i>"),i.push('<span class="ic ic-down-num"></span>'+s.downloadCount),window.viewCount=s.viewCount||0,window.downloadCount=s.downloadCount||0,a("#doc-info-"+e.id).html(i.join(""))}}),function(){var e=a(".owner-desc-wrap"),n=a(".owner-desc-label"),o=e.find(".ic-pointer"),t=e.find(".doc-desc"),c=function(){if(e.length&&o.length){var i=n.position().left;0!==+i&&i+50<=e.width()?o.css("left",i+50).show():o.hide()}};n.length&&n.delegate(".ic-arrow-up","click",function(){t.slideUp(),a(this).removeClass("ic-arrow-up").addClass("ic-arrow-down")}).delegate(".ic-arrow-down","click",function(){a(".doc-desc-wrap").css("display","none"),a(".doc-desc-label").find(".ic-arrow-up").trigger("click"),e.css("display","block"),c(),t.slideDown(),a(this).removeClass("ic-arrow-down").addClass("ic-arrow-up")}),a(".owner-desc-label .ic-arrow-down").trigger("click"),i.lang.eventCenter.addEventListener("Reader.zoomChange",function(){var n=a(".reader-container").width();a("#doc-main").css("width",n>744?n:744),e.length&&(e.css("width",n),c())})}(),function(){var e=a(".doc-desc-wrap"),n=a(".doc-desc-label"),o=e.find(".ic-pointer"),c=e.find(".doc-desc"),s=function(){if(e.length&&o.length){var i=n.position().left;0!==i&&i+40<=e.width()?o.css("left",i+40).show():o.hide()}};n.length&&n.delegate(".ic-arrow-up","click",function(){t.xsend(1,100596),c.slideUp(),a(this).removeClass("ic-arrow-up").addClass("ic-arrow-down")}).delegate(".ic-arrow-down","click",function(){t.xsend(1,100596),a(".owner-desc-wrap").css("display","none"),a(".owner-desc-label").find(".ic-arrow-up").trigger("click"),e.css("display","block"),s(),c.slideDown(),a(this).removeClass("ic-arrow-down").addClass("ic-arrow-up")}),i.lang.eventCenter.addEventListener("Reader.zoomChange",function(){var n=a(".reader-container").width();a("#doc-main").css("width",n>744?n:744),e.length&&(e.css("width",n),s())})}(),i.dom.ready(function(){var n=a("#doc-tittle-"+e.id),o=a("#docDescWrap-"+e.id),t=a("#docDesc-"+e.id),c=null,s=function(){var e=t.height();o.hasClass("unfold")||(e>20?o.addClass("overflow"):o.removeClass("overflow"))},r=t.html(),l=n.html();r&&t.html(d.wbr(r)),n.html(d.wbr(l)),s(),o.delegate(".doc-desc-more","click",function(){return o.toggleClass("unfold"),i.lang.eventCenter.dispatchEvent("viewHeader.change"),!1}),a(window).resize(function(){c&&clearTimeout(c),c=setTimeout(s,150)}),i.lang.eventCenter.addEventListener("Reader.zoomChange",function(){c&&clearTimeout(c),c=setTimeout(s,150)})}),i.dom.ready(function(){i.g("docReport-"+e.id)&&i.event.on("docReport-"+e.id,"click",function(e){i.lang.eventCenter.dispatchEvent("Report.Click",{target:this}),i.event.stop(e)}),i.dom.g("docReport-copr")&&i.event.on("docReport-copr","click",function(e){i.lang.eventCenter.dispatchEvent("Report.Click",{target:this}),i.event.stop(e)})}),this}},o.exports=u});