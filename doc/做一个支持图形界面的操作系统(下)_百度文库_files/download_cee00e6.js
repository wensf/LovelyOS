define("wkview:widget/html_view_newToolsbar/html_reader/js/newtoolsBar/download.js",function(e,o,i){var n=(e("wkcommon:widget/ui/js_core/dialogCashier/dialogCashier.js"),e("wkcommon:widget/lib/tangram/base/base.js")),t=e("wkcommon:widget/ui/js_core/widget/widget.js").widget,a=e("wkcommon:widget/ui/js_core/util/util.js"),s=e("wkcommon:widget/ui/js_core/log/log.js"),d=e("wkview:widget/html_view/html_reader/js/toolsItem.js").toolsItem,l=(e("wkview:widget/ui/view/down_doc/down_doc.js").downDocCreate,e("wkview:widget/doc_download_main/doc_download_main.js")),c=(e("wkcommon:widget/ui/js_core/login/login.js").login,e("wkcommon:widget/lib/fis/data/data.js")),r=e("wkcommon:widget/ui/js_core/_dialog/_dialog.js").alert,p=e("wkcommon:widget/sessionX/sessionX.js"),w=p.sessionXMgr,g=t({Options:{position:"centerRight",reader:{}},_init:function(){var e,o=this,i=c.get("WkInfo").DocInfo,t=i.docTicket||0,d=i.isPaymentDoc||0,l=i.isInRoomButDeletedByCreater||!1,r=i.isdownloaded||0,p=d&&!r||l?" downloadDisabled":"",w=document.getElementById("edit-docPrice"),g=+i.isPaymentDoc||0,f=+i.ispaied||0,v=+i.hangyebaogao_customized||0;if(1===+c.get("WkInfo").DocInfo.freeDoc)e=['<div class="reader-tools-btn-wrap" style="position:relative;">','    <a class="ic reader-download" href="###" ','        data-toolsBar-log="download" alog-action="htmltoolbar.download">','        <span style="display: block; position: absolute; top: -5px; ',"            right: 0px; width: 66px; font-size: 13px; height: 37px; ","            line-height: 37px; padding-left: 18px; ",'            background: url(https://edu-wenku.bdimg.com/icms_transform/img/iknow/wenku/free-doc_02.gif) no-repeat 0 -2px;">','            <span style="text-decoration: line-through;color:#999">',c.get("WkInfo").DocInfo.freeMoney+".00&nbsp;","            </span>",'            <span style="color:#e87301;">\u514d\u8d39</span>',"        </span>","    </a>","</div>"].join("");else{var m=d?"\u5df2\u8d2d\u4e70":t;i.vip_free_buy&&(m=['<span class="vip-free-buy">','<span class="original-price">\uffe5'+(i.payPrice/100).toFixed(2)+"</span><br/>",'<span class="vip-free">VIP\u514d\u8d39\u9605\u8bfb</span>',"</span>"].join(""),i.is_only_vip_doc&&(m=['<span class="vip-free-buy only_vip_doc">','<span class="vip-free">VIP\u514d\u8d39\u9605\u8bfb</span>',"</span>"].join(""))),e=g?['<div class="reader-tools-btn-wrap-new download-btn">','    <a class="reader-download ui-bz-btn-senior'+p+'"','        href="###" data-toolsBar-log="download" alog-action="htmltoolbar.download">',"        <i>"+m+"</i>",'        <b class="ui-btn-btc">\u7acb\u5373\u4e0b\u8f7d</b>',"    </a>",'    <a href="javascript:void(0)" id="tip-notice-new" style="display:none" class="vip-free-auto">',"        <i>\u52a0\u5165VIP</i></br>\u514d\u5238\u4e0b\u8f7d\u672c\u6587","    </a>","</div>"].join(""):['<div class="reader-tools-btn-wrap-new download-btn">','    <span class="doc-ticket-show">'+m+"\u4e0b\u8f7d\u5238</span>",'    <a class="reader-download ui-bz-btn-senior'+p+'"','        href="###" data-toolsBar-log="download" alog-action="htmltoolbar.download">','        <b class="ui-btn-btc">\u7acb\u5373\u4e0b\u8f7d</b>',"    </a>",'    <a href="javascript:void(0)" id="tip-notice-new" style="display:none" class="vip-free-auto">',"        <i>\u52a0\u5165VIP</i></br>\u514d\u5238\u4e0b\u8f7d\u672c\u6587","    </a>","</div>"].join("")}o.el=a.createDom(e);var _=c.get("WkInfo").PageInfo.isLogin,b=c.get("WkInfo").DocInfo.docId,h=$(o.el).find("#tip-notice-new");if(_){var u="/cashier/browse/dispatch?doc_id="+b,k=h.text().replace(/^\s+|\s+$/g,"");("\u52a0\u5165VIP\u514d\u5238\u4e0b\u8f7d\u672c\u6587"===k||"\u52a0\u5165VIP\u83b7\u53d6\u66f4\u591a\u7279\u6743"===k)&&h.attr("href",u+"&dqStatCode=31_8_171_172"),"VIP\u4e13\u4eab\u514d\u8d39\u4e0b\u8f7d"===k&&h.attr("href",u+"&dqStatCode=31_8_171_174")}$("body").on("click","#tip-notice-new",function(){var e=h.text().replace(/^\s+|\s+$/g,"");_?(s.xsend(1,100526),"\u52a0\u5165VIP\u514d\u5238\u4e0b\u8f7d\u672c\u6587"===e||"\u52a0\u5165VIP\u83b7\u53d6\u66f4\u591a\u7279\u6743"===e?(s.xsend(1,100459),s.xsend(1,101492)):"VIP\u4e13\u4eab\u514d\u8d39\u4e0b\u8f7d"===e&&(s.xsend(1,100461),s.xsend(1,101492))):"\u52a0\u5165VIP\u514d\u5238\u4e0b\u8f7d\u672c\u6587"===e||"\u52a0\u5165VIP\u83b7\u53d6\u66f4\u591a\u7279\u6743"===e?(s.xsend(1,100459),s.xsend(1,101492),s.xsend(1,100526),window.location.href="/cashier/browse/dispatch?doc_id="+b+"&dqStatCode=31_8_171_172"):h.hasClass("vip-enjoy")&&(s.xsend(1,100461),s.xsend(1,101492),s.xsend(1,100526),window.location.href="/cashier/browse/dispatch?doc_id="+b+"&dqStatCode=31_8_171_174")}),i.isPaymentDoc||!(t>0)||i.vip_type||i.edu_vip_type||i.jiaoyu_vip_type||h.css("display","inline-block"),f&&v&&g&&h.css({visibility:"hidden",display:"none"}),w&&(d||o.el.appendChild(w),n.string.trim(w.innerHTML)&&$(w).css("display","")),o.clickEl=n.dom.q("reader-download",o.el,"a")[0],o.bindEvent()},bindEvent:function(){var e=this,o=c.get("WkInfo").DocInfo,i=o.isInRoomButDeletedByCreater?"\u6743\u9650\u95ee\u9898":"\u7248\u6743\u65b9\u8981\u6c42",t=c.get("WkInfo");n.event.on(e.clickEl,"click",function(o){n.event.preventDefault(o);var a=t.DocInfo||{},d=a.docTicket,p=function(){var e=!!c.get("VipFreeDoc");return e?0:a.docTicket}(),g=a.docId;s.xsend(1,101316,{originPrice:d,salePrice:p,docId:g,type:2}),s.xsend(1,101712),s.xsend(1,100035);var f=w.getSessionItem("fromSearchOptFirst"),v=$.extend(!0,{page:"view",pos:"toolbar"},f);s.xsend(101592,v),n.lang.eventCenter.dispatchEvent("smallFlowDownBtn"),n.dom.hasClass(e.clickEl,"downloadDisabled")?r({title:"\u63d0\u793a",content:['<p style="font-size:14px;margin:20px;text-align:center;">',"    \u8be5\u6587\u6863\u56e0"+i+"\uff0c\u4ec5\u652f\u6301\u5728\u7ebf\u9605\u8bfb\u54e6\u3002","</p>"].join(""),width:350,height:180}):l.goSpecialDownload(t)}),"inline-block"===$(".vip-free-auto").css("display")&&(s.xsend(1,101491),e.jionvip=n.dom.q("vip-free-auto",e.el,"a")[0],n.event.on(e.clickEl,"click",function(){s.xsend(1,101492)}))}},{superClass:d});i.exports.download=g});